function M = CalcMyDistanceMatrix(DATA, C, varargin)%Given classsification, calculated mahal separations for all%pairs/direcioncs    p= DATA.probe(1);    AllVoltages = AllV.mygetappdata(DATA,'AllVoltages');    uid = DATA.uid;       ntr = 1;    M.errs = {};    M.errstates = {};    M.space = {};        if DATA.usegmcid        cls = unique(DATA.gmcid);    else        cls = unique(DATA.clst);    end for j = 1:length(cls)     M.D(j,j) = NaN; end  if length(cls) ==1 %all mu     M.space{1,1} = C.space(1:3); end  for j = 2:length(cls)     for k = 1:j-1         a = AllV.FindBestSpace(DATA,C,'clusters',j,k);         M.D(j,k) = a.isolation(1);         M.D(k,j) = a.isolation(2);         M.space{j,k} = a.space;         M.space{k,j} = a.space;     end end M.bestscores = max([min(M.D'); min(M.D)]);