function DATA = CalcTemplateScores(DATA,  varargin)j = 1;while j <= length(varargin)    if isfield(varargin{j},'ms')        MeanSpike = varargin{j};    end    j = j+1;end    if exist('MeanSpike','var')    elseif  isfield(DATA.cluster,'TemplateUsed')        MeanSpike.ms = DATA.cluster.TemplateUsed;        if ~isfield(DATA.cluster,'mumeanUsed')            MeanSpike.mu = DATA.cluster.MeanSpike.mu;        elseif size(DATA.cluster.mumeanUsed,1) == length(DATA.cluster.chspk)            MeanSpike.mu(DATA.cluster.chspk,:) = DATA.cluster.mumeanUsed;        else            MeanSpike.mu = DATA.cluster.mumeanUsed;        end        MeanSpike.vdprime(DATA.cluster.chspk,:) = DATA.cluster.DprimeUsed;    elseif ~isfield(DATA.cluster,'MeanSpike')        [MeanSpike, details] = AllV.PlotMeanSpike(DATA,'noplot');        if isempty(DATA.clst)            DATA.clst(details.id) = 2;            DATA.clst(details.nid) = 1;        end    else        MeanSpike = DATA.cluster.MeanSpike;    end    DATA = AllV.CalcTemplatesFromMean(DATA, MeanSpike, varargin{:});