function C = ClusterFromBoundary(E, C)    f = fields(E);    for j =  1:length(f)        C.(f{j}) = E.(f{j});    end        if isfield(E,'angle') && E.pos(1) == E.pos(3)        C.angle = E.angle;        C.crit =E.pos(1);    else        C.angle = atan(diff(E.pos([1 3]))/diff(E.pos([2 4])));        exy = xyrotate(E.pos([1 3]),E.pos([2 4]),C.angle);        C.crit = mean(exy(:,1));    end    C.len = abs(diff(E.pos([1 3])) + i * diff(E.pos([2 4])));    C.ctype = 0;        