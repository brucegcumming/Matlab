function C = CutAndPlot(x,y, energy)    [as,bs] = AllV.BestAngle(x,y,1);    C.angle = as;    xy = xyrotate(x,y,C.angle);%    [crit,b] = FindDip(xy(:,1),energy,'plot');    [crit,b] = GMDip(xy,energy,'plot');    C.crit = crit(1);    C.hdip = as;    C.bmc = AllV.BimodalCoeff(xy(:,1),1.5);   hold off;    id = find(xy(:,1) > crit(1));   nid = find(xy(:,1) <= crit(1));   plot(x(id),y(id),'r.','markersize',1);   hold on;   plot(x(nid),y(nid),'.','markersize',1);   smw = round(size(xy,1)./500);   [pdf, xv] = smhist(xy(:,1),smw);   if mean(xv < 0)       xv = -xv;   end   xv = (xv-min(xv)) .* range(x)./range(xv);   plot(xv, pdf .* max(y)./max(pdf));   title(sprintf('Dips %.4f,%.3f',C.hdip,C.bmc));    