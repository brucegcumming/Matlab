function [SSD,dipr, details ] = EllipseDip(params, DATA, state)%[SSD, details ] = AllV.MinimiseEllipseb(params, DATA, state)%find ellipze that maximizes separation of 2 Gaussian fits in 1d%does not allow change to ellipse aspectratiocx = params(1);cy = params(2);if length(params) == 2    rx = state.rx;    ry = state.ry;    a = state.angle;elseif length(params) == 4rx = params(3);ry = params(3) * state.initialar;a = params(4);endxy = DATA.xy{state.cluster};xys = xyrotate(xy(:,1)-cx,(xy(:,2)-cy) ./state.aspectratio,a);r = ((xys(:,1))./rx).^2 + ((xys(:,2))./(ry./state.aspectratio)).^2;a = MyDip(sqrt(r));SSD = a.dipsize(2);dipr = a.x(a.dip(2));details.r = sqrt(r);