function [DATA, A] = ExcludeTrials(DATA, trials,  add)    if add == 1        DATA.excludetrialids = cat(2, DATA.excludetrialids,[DATA.Expt.Trials(trials).id]);    else        DATA.excludetrialids = trials;    end            id = find(ismember([DATA.Expt.Trials.id],DATA.excludetrialids));    iid = [];    for j = id        oid = find(DATA.t > DATA.Expt.Trials(j).Start(1)./10000 - DATA.preperiod & ...            DATA.t < DATA.Expt.Trials(j).End(end)/10000 + DATA.postperiod);        iid = [iid oid];    end    uid = unique(iid); %events to remove    DATA.clst(uid) = -1;    DATA.uid = setdiff(1:DATA.nevents,uid);    A = AllV.mygetappdata(DATA,'AllVoltages');    A = A(:,:,DATA.uid);    DATA.energy = DATA.energy(:,DATA.uid);    DATA.spkvar = DATA.spkvar(:,DATA.uid);    DATA.rV = DATA.rV(DATA.uid);    DATA.meanV = DATA.meanV(:,DATA.uid);    DATA.clst = DATA.clst(DATA.uid);    DATA.t = DATA.t(DATA.uid);    DATA.uid = 1:length(DATA.uid);    DATA.nevents = length(DATA.uid);    AllV.mysetappdata(DATA,'AllVoltages',A);    set(DATA.toplevel,'UserData',DATA);    AllV.SetTrialList(DATA);