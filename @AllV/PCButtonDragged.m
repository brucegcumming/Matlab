 function PCButtonDragged(src, data)DATA = GetDataFromFig(src);if isfield(DATA,'elmousept')if  DATA.elmousept.down == 1    start = get(gca,'CurrentPoint');    DATA.elmousept.pos(3) = start(1,1);    DATA.elmousept.pos(4) = start(1,2);    DATA.elmousept.h = AllV.DrawEllipse(DATA.elmousept, DATA.elmousept.plotargs{:});%    drawnow;%    mytoc(DATA.ts);elseif  DATA.elmousept.down == 3 %set radius with R mouse button    start = get(gca,'CurrentPoint');    r = abs(start(1,1:2) - DATA.elmousept.xyr(1:2));    sina = sin(DATA.elmousept.angle);    cosa = cos(DATA.elmousept.angle);    r = r * [cosa sina; -sina cosa];    DATA.elmousept.xyr([3 4]) = r;    DATA.elmousept.pos(1) = DATA.elmousept.xyr(1)-DATA.elmousept.xyr(3);    DATA.elmousept.pos(2) = DATA.elmousept.xyr(2)-DATA.elmousept.xyr(4);    DATA.elmousept.pos(3) = DATA.elmousept.xyr(1)+DATA.elmousept.xyr(3);    DATA.elmousept.pos(4) = DATA.elmousept.xyr(2)+DATA.elmousept.xyr(4);    DATA.elmousept.h = AllV.DrawEllipse(DATA.elmousept, DATA.elmousept.plotargs{:});elseif  DATA.elmousept.down == 2 %moving ellipse    start = get(gca,'CurrentPoint');    DATA.elmousept.pos(1) = start(1,1)-DATA.elmousept.start(1)+DATA.elmousept.xyr(1)-DATA.elmousept.xyr(3);    DATA.elmousept.pos(2) = start(1,2)-DATA.elmousept.start(2)+DATA.elmousept.xyr(2)-DATA.elmousept.xyr(4);    DATA.elmousept.pos(3) = start(1,1)-DATA.elmousept.start(1)+DATA.elmousept.xyr(1)+DATA.elmousept.xyr(3);    DATA.elmousept.pos(4) = start(1,2)-DATA.elmousept.start(2)+DATA.elmousept.xyr(2)+DATA.elmousept.xyr(4);    DATA.elmousept.h = AllV.DrawEllipse(DATA.elmousept, DATA.elmousept.plotargs{:});endset(DATA.toplevel,'UserData',DATA);end