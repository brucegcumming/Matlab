function PlotGridSpikes(DATA, nspk, varargin)    Clusters = AllV.mygetappdata(DATA,'Clusters');    voff  = 0;    hoff = 0;    hold off;    for j = 1:DATA.allnprobes        if mod(j,10) == 1            voff = 0;        end        s = AllV.SpkFileName(DATA,'probe',j);        Spikes = ReadSpikeFile(s,'double');        id = ceil(rand(1,nspk) .* size(Spikes.values,1));        cells = unique(Spikes.codes(:,1));        mysubplot(10,10,CalcSubPlot(10,10,j, DATA.ArrayConfig),'tight');        hold off;        for c = 1:length(cells)            cid = find(Spikes.codes(id,1) == cells(c));            if ~isempty(cid)                plot(Spikes.values(id(cid),:)','color',DATA.colors{cells(c)+1});                hold on;                set(gca,'xtick',[],'ytick',[]);                axis('tight');            end            yl = get(gca,'ylim');        end        if AllV.isacell(DATA, DATA.exptno, j)            c = AllV.MarkAxes(gca, 100);        elseif isfield(Clusters{j},'marked')            c = AllV.MarkAxes(gca, Clusters{j}.marked);            if Clusters{j}.marked == 0 && isfield(Clusters{j},'recluster')                if Clusters{j}.recluster > 90 %automatice reapply of some kind                c = [0 0 1];                end            end                        elseif Clusters{j}.manual            c = [0 0 1];                    else            c = [1 0 0];        end        text(10,yl(2),sprintf('%d',j),'fontweight','bold',...            'horizontalalignment','left','verticalalignment','top','color',c,'Tag','ProbeLabel');        AllV.AddSelectorContextMenu(DATA, gca, j);    end