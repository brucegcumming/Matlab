function DATA = SetCellEntry(DATA, C,  e, p, c, cellid, varargin)        savelist = 1;    j = 1;     while j <= length(varargin)        if strncmpi(varargin{j},'nosave',6)            savelist = 0;        end        j = j+1;    end    if isempty(C)        Clusters = AllV.mygetappdata(DATA,'Clusters');        C = Clusters{e}{p};    end    quality = 4;    if c < 0        id = find(DATA.CellList(e,p,:) == cellid);        if length(id) == 1            quality = 4 + c;            c = id;        else            return;        end    end    oldcell = DATA.CellList(e,p,c);    id = find(DATA.CellList(e,p,:) == cellid);    DATA.CellList(e,p,id) = 0; %remove this cell from other clusters this expt    DATA.CellList(e,p,c) = cellid;    if c > 1        if c > length(C.next)+1            return;        end        C = C.next{c-1};    end    if isfield(C,'excludetrialids') && length(C.excludetrialids)        % find trial #s that match the ids excluded        DATA.CellDetails.excludetrials{e,p,c} = union(DATA.CellDetails.excludetrials{e,p,c}, C.excludetrialids);    end    DATA.CellDetails.Quality(e,p,c) = quality; %default    if CellIsEmpty(DATA.CellDetails,'MeanSpike', cellid)        DATA.CellDetails.MeanSpike{cellid}.ms = C.MeanSpike.ms(DATA.chspk,:);        DATA.CellDetails.MeanSpike{cellid}.chspk = DATA.chspk;    end    if savelist        AllV.SaveCellList(DATA);    end