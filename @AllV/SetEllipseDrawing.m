function DATA = SetEllipseDrawing(DATA, shape,varargin)cluster = 1;boundarytype=1;plotargs = {};F = DATA.toplevel;DATA.elmousept.type = 'cluster';DATA.elmousept.selected = [];    j = 1;    while j <= length(varargin)        if strncmpi(varargin{j},'cluster',4)            j = j+1;            cluster = varargin{j};        elseif strncmpi(varargin{j},'boundarytype',10)            j = j+1;            boundarytype = varargin{j};        elseif strncmpi(varargin{j},'gmm',3)            DATA.elmousept.type = varargin{j};        elseif strncmpi(varargin{j},'figure',6)            j = j+1;            F = findobj('type','figure','tag',varargin{j});        else            plotargs = {plotargs{:} varargin{j}};        end        j = j+1;    end    tic;DATA.elmousept.boundarytype = boundarytype;DATA.currentcluster = cluster;DATA.elmousept.h= -1;if length(DATA.elmousept.handles) >= cluster && ishandle(DATA.elmousept.handles(cluster))    DATA.elmousept.h = DATA.elmousept.handles(cluster);endDATA.elmousept.shape= shape;DATA.elmousept.down = 0;DATA.elmousept.done = 0;DATA.elmousept.angle = 0;DATA.elmousept.cluster = cluster;DATA.elmousept.plotargs = plotargs;DATA.elmousept.color = DATA.colors{cluster+1};C = AllV.GetClusterDef(DATA.cluster, cluster);if isfield(C,'shape') && C.shape == 0    DATA.elmousept.pos = AllV.xyr2pos(C.xyr);    DATA.elmousept.angle = C.angle;    DATA.elmousept.xyr = C.xyr;endDATA.elmousept.dragfcn = get(F,'WindowButtonMotionFcn');DATA.clustericon = AllV.SetClusterIcon(DATA);%should get old Fcns, then reset them after button releaseset(F, 'interruptible','off');set(F, 'WindowButtonDownFcn',@AllV.ButtonPressed);set(F, 'WindowButtonMotionFcn',@AllV.PCButtonDragged);set(F, 'WindowButtonUpFcn',@AllV.ButtonReleased);set(F, 'WindowScrollWheelFcn',@AllV.ScrollWheel);set(F,'UserData',DATA);tocsv = findobj('type','figure','Tag',DATA.tag.vare);X.parentfig = DATA.toplevel;X.elmousept = DATA.elmousept;set(sv, 'WindowButtonDownFcn',@AllV.ButtonPressed);set(sv, 'WindowButtonMotionFcn',@AllV.PCButtonDragged);set(sv, 'WindowButtonUpFcn',@AllV.ButtonReleased);set(sv, 'WindowScrollWheelFcn',@AllV.ScrollWheel);set(sv,'UserData',X);sv = findobj('type','figure','Tag',DATA.tag.tmplscore);X.parentfig = DATA.toplevel;X.elmousept = DATA.elmousept;set(sv, 'WindowButtonDownFcn',@AllV.ButtonPressed);set(sv, 'WindowButtonMotionFcn',@AllV.PCButtonDragged);set(sv, 'WindowButtonUpFcn',@AllV.ButtonReleased);set(sv, 'WindowScrollWheelFcn',@AllV.ScrollWheel);set(sv,'UserData',X);%set(F, 'Interruptible','off');