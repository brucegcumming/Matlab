function DATA = TemplateGMFits(DATA)            p= DATA.probe(1);    uid = DATA.uid;    %when doing this from scratch (remaking template from other cut), use    %several starts to make sure the PC cut is best.     %Now uses AllV.GMfit that set a sensible start point.        tmspace = DATA.tmplspace(2,:);    tmspace = tmspace(tmspace>0);    pcs = DATA.TemplateScores(uid,tmspace);    ncells = 2:DATA.ncelltotry;    for j = 1:length(ncells)        [P, distance(j), a] = AllV.GMfit(pcs,ncells(j),1);        details.pctook = a.took;        objs{j} = P;        [d, dd] = AllV.gmdprime(P);        cid = cluster(P, pcs);% mahal distance is unsigned, not so useful        if ncells(j) == DATA.ncelltotry(2)            DATA.gmcid = cid;            DATA.usegmcid = 1;            distances = dd.d;        end        details.Converged(j) = P.Converged;        ll(j) = P.NlogL;    end    GetFigure(DATA.tag.dips);    mysubplot(1,4,1:3);    imagesc(distances);    caxis([0 5]);    mysubplot(1,4,4);    plot(ll,1+[1:length(ll)],'o-');    set(DATA.toplevel,'UserData',DATA);    