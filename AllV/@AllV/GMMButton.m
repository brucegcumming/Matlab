function GMMButton(DATA, E, fcn)    C = DATA.cluster.jamescluster;    if strcmp(fcn,'gmmsplit')    split = 1;    angle = atan(diff(E.pos([1 3]))/diff(E.pos([2 4])));    exy = xyrotate(E.pos([1 3]),E.pos([2 4]),angle);    crit = mean(exy(:,1));    xy = xyrotate(DATA.spikefeatures(:,E.pcplot(1)),DATA.spikefeatures(:,E.pcplot(2)),angle);    init_comp_idx = C.comp_idx;    init_cluster_labels = C.cluster_labels;    if split        C.Ncomps = C.Ncomps+1;        init_comp_idx(xy(:,1)>crit) = max(init_comp_idx) + 1;        init_cluster_labels(end+1) = max(init_cluster_labels) + 1;    end    DATA = AllV.RunGMMFit(DATA,C,'replot');    elseif strcmp(fcn,'gmmadd')        angle = atan(diff(E.pos([1 3]))/diff(E.pos([2 4])));        xy = xyrotate(DATA.spikefeatures(:,E.pcplot(1))-E.xyr(1),DATA.spikefeatures(:,E.pcplot(2))-E.xyr(2),angle);        d = abs(xy(:,1)./E.xyr(3) + i*xy(:,2)./E.xyr(4));        new = max(C.comp_idx)+1;        C.comp_idx(d<1) = new;        DATA.gmcid = C.comp_idx;        DATA = AllV.ReplotPCs(DATA,[]);        C.Ncomps = new;        DATA =AllV.RunGMMFit(DATA, C, 'replot');    elseif strcmp(fcn,'gmmmerge')        xy = DATA.spikefeatures(:,E.pcplot(1)) + i.* DATA.spikefeatures(:,E.pcplot(2));        exy = E.pos(1)+i*E.pos(2);        d = abs(xy - exy);        id = find(d < prctile(d,10));        [a,b] = Counts(C.comp_idx(id));        [a,c] = max(a);        if isempty(DATA.elmousept.selected)            fprintf('First selected component %d\n',b(c));            DATA.elmousept.selected(1) = b(c);        else            cn(1) = DATA.elmousept.selected(1);            cn(2) = b(c);            fprintf('Selected components %d,%d\n',cn);            cid = C.comp_idx == (max(cn));            C.comp_idx(cid) = min(cn);            C.cluster_labels(max(cn)) = [];            for j = max(cn)+1:C.Ncomps                C.comp_idx(C.comp_idx == j) = j-1;            end            C.Ncomps = C.Ncomps-1;            if length(unique(C.cluster_labels)) == 1                C.cluster_labels(end) = 2;            end            DATA = AllV.RunGMMFit(DATA,C,'replot');        end    end    set(DATA.toplevel,'UserData',DATA);      