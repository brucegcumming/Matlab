function [nt, spklst] = PlotTrialSpikes(DATA, nt, varargin)        spklst = [];if length(nt) > 1    for j = 1:length(nt)        if j == length(nt)            [k, spklst] = AllV.PlotTrialSpikes(DATA, nt(j), varargin{:},'setcontext');        else            [k, spklst] = AllV.PlotTrialSpikes(DATA, nt(j), varargin{:});        end        drawnow;    end    nt = k;    AllV.FinishSpikePlot(DATA);    return;endif nt < 1     nt = 1;    return;endif ~isfield(DATA.Expt,'Trials')    cprintf('error','Expt Is Missing Trials\n')    nt = 0    return;endif  nt > length(DATA.Expt.Trials)    nt = length(DATA.Expt.Trials);    return;endargs = {};probes = [];j = 1;while j <= length(varargin)    if strncmpi(varargin{j},'probes',5)        j = j+1;        probes = varargin{j};    else        args = {args{:} varargin{j}};    end    j = j+1;endif DATA.plotspk.allprobes    npts = length(DATA.spts);    Vall = AllV.mygetappdata(DATA,'Vall');    if isempty(probes)        probes = 1:size(Vall.V,1);    end    T = DATA.Expt.Trials(nt);    for p = probes        spklst = find(Vall.t(DATA.trigtimes{p}) .*10000 > DATA.Expt.Trials(nt).Start(1) & Vall.t(DATA.trigtimes{p}) .*10000 < DATA.Expt.Trials(nt).End(end));        xoff = floor((p-1)/6) .* npts;        yoff = (rem(p-1,6)) * DATA.vsep;        AllV.PlotProbeSpikes(DATA, Vall, p, DATA.trigtimes{p}(spklst),[npts 8],[xoff yoff]);    end    c = AllV.TrialMarkChar(DATA.Expt.Trials(nt));    title(sprintf('Trial %d (du%.2f)%c: ed%.2f,st%.0f',DATA.Expt.Trials(nt).Trial, T.dur./10000,c,T.ed,T.st));    drawnow;else    t(1) = DATA.Expt.Trials(nt).Start(1);    t(2) = DATA.Expt.Trials(nt).End(end);    if DATA.plotspk.includeprepost        t(1) = t(1) - DATA.preperiod.*10000;        t(2) = t(2) + DATA.postperiod.*10000;    end    spklst = find(DATA.t .*10000 > t(1) & DATA.t.*10000 < t(2));    DATA.spklst = spklst;    DATA.currenttrial = nt;    AllV.PlotSpikes(DATA,DATA.spklst,'fixy',args{:});    D = get(gcf,'UserData');    D.plottype = 'TrialSpikes';    set(gcf,'UserData',D);endDATA.currenttrial = nt;% set(DATA.toplevel,'UserData',DATA);