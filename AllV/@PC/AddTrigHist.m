function AddTrigHist(DATA, C, cl, varargin)    %superimposes a histogram of trigger values on current axes.rV = [];    j = 1;while j <= length(varargin)    j = j+1;endif isfield(C,'triggerV') && isfield(C,'triggerV') && length(C.triggerV) == length(C.clst)    clst = C.clst;    rV = C.triggerV;enddrawall = 1;cl = 1;  %%Forces drawing of allif cl > 1 && length(C.next) > cl-2 && isfield(C.next{cl-1},'vhist')    C = C.next{cl-1};endif ~isempty(rV)    C.vhist = hist(rV(clst ==cl+1),100);elseif ~isfield(C,'vhist');    return;end        h = ishold;hold on;xl = get(gca,'xlim');yl = get(gca,'ylim');x = linspace(xl(1),xl(2),length(C.vhist));plot(x,yl(1)+C.vhist.*diff(yl)./max(C.vhist),'color',DATA.colors{cl+1});vhist = [];if drawall    for j = 1:length(C.next)        if ~isempty(rV)            vhist = hist(rV(clst ==cl+1+j),100);        elseif isfield(C.next{j},'vhist')            x = linspace(xl(1),xl(2),length(C.next{j}.vhist));            vhist = C.next{j}.vhist;        end        if ~isempty(vhist)            plot(x,yl(1)+vhist.*diff(yl)./max(vhist),'color',DATA.colors{j+2});        end    endendif ~ishold    hold off;end