function DATA = CalcCellMeans(DATA)    cellid = unique(DATA.CellList(:));    cellid = cellid(cellid > 0);    Clusters = getappdata(DATA.toplevel,'Clusters');    for j = 1:length(cellid)        c = cellid(j);        id = find(DATA.CellList==c);        [eid,pid,cl] = ind2sub(size(DATA.CellList),id);        C = Clusters{eid(1)}{pid(1)};        ms = zeros(length(C.chspk),size(C.MeanSpike.ms,2));        chspk = [];        for e = 1:length(eid)            ichspk = Clusters{eid(e)}{pid(e)}.chspk;            ms = ms + Clusters{eid(e)}{pid(e)}.MeanSpike.ms(ichspk,:);            chspk(e,:) = ichspk;        end        DATA.CellDetails.MeanSpike{c}.ms = ms./length(e);        DATA.CellDetails.MeanSpike{c}.chspk = mean(chspk);    end    PC.SaveCellList(DATA);    