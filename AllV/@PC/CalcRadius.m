    function [r,y] = CalcRadius(E,xy)                        rx = E.xyr(3);        ry = E.xyr(4);        if isfield(E,'aspectratio') & E.aspectratio > 0            xys = xyrotate(xy(:,1)-E.xyr(1),(xy(:,2)-E.xyr(2)) ./E.aspectratio,E.angle);            r = ((xys(:,1))./rx).^2 + ((xys(:,2))./(ry./E.aspectratio)).^2;        else            xys = xyrotate(xy(:,1)-E.xyr(1),xy(:,2)-E.xyr(2),E.angle);            r = ((xys(:,1))./rx).^2 + ((xys(:,2))./ry).^2;        end        if nargout > 1            y = xys(:,2);        end