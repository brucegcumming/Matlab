function CallAllVPcs(DATA, eid, pid, varargin)    cargs = {};j = 1;while j <= length(varargin)    if strncmpi(varargin{j},'forecfullv',6)        DATA.allvpcsmode = 'fullv'; %dont return and set - temporary    elseif strncmpi(varargin{j},'lastcut',6)        cargs = {cargs{:} 'applylast'};    elseif strncmpi(varargin{j},'refcut',3)        cargs = {cargs{:} 'refcut'};    end    j = j+1;end    if DATA.usealltrials        args = {'usealltrials'};    else        args = {};    end    Expts = getappdata(DATA.toplevel,'Expts');    if length(Expts) >= eid && ~isempty(Expts{eid})        args = {args{:}, 'Expts', Expts};    end    ts = now;    AllFullV = getappdata(DATA.toplevel,'AllFullV');    if strcmp(DATA.allvpcsmode,'fromspikes')        name = sprintf('%s/Expt%dSpikes',DATA.name,DATA.exptid(eid));        args = {args{:} 'tchan' pid};        AllVPcs(name,args{:},'reapply','nocheck', cargs{:});    elseif ~isempty(AllFullV)        exs = CellToMat(AllFullV,'exptno');        id = find(exs == DATA.exptid(eid));        args = {args{:} 'tchan' pid};        AllVPcs(AllFullV{id},args{:},DATA.allvpcsmode,'nocheck',cargs{:});    else                if strncmp(DATA.DataType,'Grid',4)            name = sprintf('%s/Expt%d.p%dFullV.mat',DATA.name,DATA.exptid(eid),pid);        else            name = sprintf('%s/Expt%dFullV.mat',DATA.name,DATA.exptid(eid));            args = {args{:} 'tchan' pid};        end        if exist(name)            AllVPcs(name,args{:},DATA.allvpcsmode,cargs{:});        end    end    fprintf('Calling AllVPcs took %.1f sec\n',mytoc(ts));