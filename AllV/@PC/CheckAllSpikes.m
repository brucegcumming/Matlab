function [S, new] = CheckAllSpikes(DATA, e,p, varargin)    S = getappdata(DATA.toplevel, 'AllSpikes');    sz = size(S);    new = 0;    PC.CheckClusterLoaded(DATA,e);    for j = 1:length(e)        if sum(size(e) == size(p)) == 2            if sz(1) < e(j) || sz(2) < p(j) || ~isfield(S{e(j),p(j)},'values')                S =  PC.AddSpikes(DATA, S, e(j),p(j),varargin{:});                new = new+1;            end        else            for k = 1:length(p)                if sz(1) < e(j) || sz(2) < p(k) || ~isfield(S{e(j),p(k)},'values')                    S =  PC.AddSpikes(DATA, S, e(j),p(k),varargin{:});                    new = new+1;                end            end        end    end    if new        setappdata(DATA.toplevel,'AllSpikes',S);    end    