function CompareProbes(DATA, type)spk = 1;ids = [];DATA.nprobes = 24;PC.SetFigure(DATA, DATA.tag.clusters,'front');clf;for j = 1:length(DATA.strings)    x = PC.CompareProbesShape(DATA, j, type);    if length(x.shapexc) == DATA.nprobes    C(j,:,:) = x.shapexc;    xca(j,:) = x.xca;    xcb(j,:) = x.xcb;    end    drawnow;endPC.SetFigure(DATA, DATA.tag.all,'front');subplot(1,2,1);Cmean = squeeze(mean(C));imagesc(Cmean);subplot(1,2,2);hold off;plot(mean(xca));hold on;plot(mean(xcb),'r');set(gca,'xlim',[1 DATA.nprobes]);[E,V] = eig(Cmean);PC.SetFigure(DATA,DATA.tag.eigenvectors,'front')hold off; colors = mycolors;for j = 0:5    plot(E(:,end-j),'color',colors{j+1});    hold on;end