function CompareShape(DATA, Clusters, spk)ids = [];  for j = 1:length(DATA.strings)      if length(Clusters{j}) >= spk && ~isempty(Clusters{j}{spk}) && size(Clusters{j}{spk}.MeanSpike.ms,1) == 24 ...              && GoodCluster(Clusters{j}{spk});          ids = [ids j];      end  end    for j = 1:length(ids)      for k = 1:length(ids)          a = Clusters{ids(j)}{spk}.MeanSpike.ms;          b = Clusters{ids(k)}{spk}.MeanSpike.ms;          l = min([size(a,2) size(b,2)]);          a = a(:,1:l);          b = b(:,1:l);          c = corrcoef(a(:),b(:));          xc(j,k) = c(1,2);      end  endimagesc(xc);[E,V] = eig(xc);allid = [];allxc = [];for j = 1:size(E,1)    p = E(:,j);    [a,b] = max(abs(p));    id = find(xc(b,:) > 0.8);    allid = [allid id];    allxc = [allxc xc(b,:)];end