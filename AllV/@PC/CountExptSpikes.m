function Expt = CountExptSpikes(DATA,Expt,C,clnum)%Expt = PC.CountExptSpikes(DATA,Expt,C,clnum)%finds spikes in C that match trials in Expt, and%adds them to the Expt.Trials strucutre.%clnum 1 = cluster 1, i.e. C.clst == 2    if isempty(Expt) || isempty(C)        Expt.Header.cellnumber = 0;        Expt.Header.probe = 0;        return;    end    cellid = DATA.CellList(C.exptid,C.probe(1),clnum);    if cellid > 0        xcl = PC.FindExcludedTrials(DATA,C.exptid,C.probe(1),clnum,C);        xid = [Expt.Trials(xcl).id];        Expt.Header.cellnumber = cellid;    else        xid = [];        Expt.Header.cellnumber = 0;    end    Expt.Header.probe = C.probe(1);    Expt = PC.CountSpikes(Expt, C, clnum, xid);    return;    spkt = C.times(C.clst == clnum) .*10000;     for j = 1:length(Expt.Trials)         id = find(spkt > Expt.Trials(j).Start(1) & spkt < Expt.Trials(j).End(end));         Expt.Trials(j).Spikes = round(spkt(id)'-Expt.Trials(j).Start(1));         Expt.Trials(j).count = sum(spkt(id) > 500 & spkt(id) < Expt.Trials(j).dur+500);     end    