 function EstimateDrift(DATA, where)     Clusters = getappdata(DATA.toplevel,'Clusters');     for e = 1:length(Clusters)-1         for p = 3:length(Clusters{e})-2             for j = -1:1;                 a = Clusters{e}{p}.MeanSpike.ms(p-1:p+1,:);                 b = Clusters{e+1}{p+j}.MeanSpike.ms(p+j-1:p+j+1,:);                 l = min([size(a,2) size(b,2)]);                 a = a(:,1:l);                 b = b(:,1:l);                 c = corrcoef(a(:),b(:));                 xc(e,p,j+2) = c(1,2);             end         end     end     peaks = squeeze(sum(xc,2));     [a,b] = max(peaks');     dpos = cumsum(b-2);     if strcmp(where,'cell')         PC.SetFigure(DATA,DATA.tag.celllist)         plot(DATA.nprobes/2+dpos,[1:length(Clusters)-1]+0.5,'w:');     end