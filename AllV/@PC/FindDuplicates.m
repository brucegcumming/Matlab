function FindDuplicates(DATA, cell)    eid = cell(1);    p = cell(2);    cl = cell(3);    C= getappdata(DATA.toplevel,'Clusters');    Clusters = C{eid};    nc = 1;        D = getappdata(DATA.toplevel,'DuplicatePlot');    if isfield(D,'epc') && sum(D.epc == cell) == 3        cells = getappdata(DATA.toplevel,'xcCellList');        p =  D.p;%        cid = find([cells.p] == p & [cells.cl] == cl);        cellid = DATA.CellList(eid, cell(2),cl);        xcorrs = getappdata(DATA.toplevel,'xcorrs');        cid = find([cells.p] == cell(2) & [cells.cl] == cl);    else    for k = 1:length(Clusters)        if DATA.plot.dprimemin == 0 || (Clusters{k}.fitdprime(1) < DATA.plot.dprimemin)            cells(nc).p = k;            cells(nc).cl = 1;            cells(nc).dropi = Clusters{k}.dropi(3);            cells(nc).dprime = Clusters{k}.fitdprime(1);            if isfield(Clusters{k},'clst')                t = find(Clusters{k}.clst == 2);                Clusters{k}.times = Clusters{k}.times(t);            end            nc = nc+1;        end        for j = 1:length(Clusters{k}.next)            if isfield(Clusters{k}.next{j},'times') && ...                    (DATA.plot.dprimemin == 0 || Clusters{k}.next{j}.fitdprime(1) < DATA.plot.dprimemin)                cells(nc).p = k;                cells(nc).cl = 1+j;                cells(nc).dropi = Clusters{k}.next{j}.dropi(3);                cells(nc).dprime = Clusters{k}.next{j}.fitdprime(1);                nc = nc+1;            end        end    end    cid = find([cells.p] == p & [cells.cl] == cl);    cellid = DATA.CellList(eid, p,cl);    PC.SetFigure(DATA,DATA.tag.xcorr);    [cells, xcorrs] = PlotAllXcorr(DATA, Clusters,cells,'sublist',cid,'callback',@PC.PlotXcorr);    id = find(max(cat(1,xcorrs.efficacy)') > 0.2);    p = unique([xcorrs(id).p]);    end    otherp = setdiff(p,cid);    D.p = p;    D.eid = eid;    D.cell = cellid;    D.epc = cell;    setappdata(DATA.toplevel,'DuplicatePlot',D);    axdata.eid = eid;    axdata.p = p;    axdata.cell = cellid;    GetFigure(DATA.tag.xcorrpop,DATA.toplevel);    ClearPlot;    subplot(2,1,1);    hold off;    for j = 1:length(xcorrs)        if sum(xcorrs(j).efficacy) > 0            ydata(j) = max(xcorrs(j).efficacy);        h = plot(xcorrs(j).shapexc, ydata(j),'o',...            'buttondownfcn',{@PC.PlotXcorr, xcorrs(j).p(1),xcorrs(j).p(2)});        [isdup, dupi] = ismember(xcorrs(j).p,otherp);        if sum(isdup)            a = find(p == otherp(max(dupi)));            set(h,'color',DATA.colors{a},...                'markerfacecolor',DATA.colors{a});        end        hold on;        else            ydata(j) = NaN;        end    end    set(gca,'yscale','log','ylim',[min(ydata) 1]);    ylabel('Efficacy');    xlabel('Shape Xcorr');    subplot(2,1,2);    dx = diff(minmax([cells(p).dprime]))./50;    for j = 1:length(p)        cstr = '';        [a,b] = PC.isacell(DATA,eid,cells(p(j)).p,cells(p(j)).cl);        if a            cstr = sprintf('C%d',b);        elseif b < 0            cstr = sprintf('Dup%d',-b);                    end        h = plot(cells(p(j)).dropi,cells(p(j)).dprime,'o','color',DATA.colors{j});        text(cells(p(j)).dropi+dx,cells(p(j)).dprime,...            sprintf(' %d/%d%s',cells(p(j)).p,cells(p(j)).cl,cstr),...            'horizontalalignment','left','color',DATA.colors{j});        PC.AddLineContextMenu(DATA, h, eid,cells(p(j)).p,'cellnum',p(j),'duplicate',cellid);        set(h,'buttondownfcn',{@PC.PlotXcorr, cid,p(j)},...                'markerfacecolor',DATA.colors{j});        hold on;    end    ylabel('Fit Dprime');    xlabel('DropIndex');    set(gca,'UserData',axdata);    title(sprintf('%d/%d',cells(cid).p,cells(cid).cl));    PC.PlotXcorr(DATA, 'histograms',p);        