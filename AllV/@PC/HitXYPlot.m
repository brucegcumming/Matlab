 function HitXYPlot(src, b, e,p)    DATA = GetDataFromFig(src);        cmenu = get(src,'UIContextMenu');    axdata = get(gca,'UserData');    if isfield(axdata,'allxy') && DATA.allclustering == 1        return;    end    bt = strmatch(get(gcf,'SelectionType'),{'normal' 'alternate'  'extend'  'open'});    if bt == 2  && ~isempty(cmenu)        return;    end    if ~isfield(DATA,'selectprobe')        DATA.selectprobe = zeros(length(DATA.exptid),DATA.nprobes);    end    if e > size(DATA.selectprobe,1) ||  p > size(DATA.selectprobe,2)        DATA.selectprobe(e,p) = 1;    end    DATA.selectprobe(e,p) = ~DATA.selectprobe(e,p);    if DATA.selectprobe(e,p) && bt == 3 %shift select        if isfield(axdata,'type')            fg = get(gca,'Parent');            c = get(fg,'Children');            types = get(c,'type');            axid = strmatch('axes',types);            if strcmp(axdata.type,'probeexpt')                for j = 1:length(axid)                    a = get(c(axid(j)),'UserData');                    exlist(j) = a.eid;                end                [b, a] = sort(exlist);                axid = axid(a); %sorte by exlist                id = find(DATA.selectprobe(:,p) > 0);                a = max(id(id < e));                if isempty(a)                    a = min(id(id > e));                else                    DATA.selectprobe(a:e,p) = 1;                    ax = gca;                    for j = a:e                        set(c(axid(j)),'color',[0 0 0]);                    end                    axes(ax);                end            end        end    end    if DATA.selectprobe(e,p)        set(gca,'color',[0 0 0]);        if bt ~= 3        DATA = PC.ShowData(DATA,e,p,'oneprobe');        end    else        set(gca,'color',[1 1 1]);    end    DATA.currentpoint = [e p];    PC.SetFigure(DATA,DATA.tag.all);%    DATA.markh = PC.DrawBox(DATA.currentpoint(1),DATA.currentpoint(2),'color','w');    set(DATA.toplevel,'UserData',DATA);    