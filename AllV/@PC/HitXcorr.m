 function HitXcorr(a,b, id, ex, cells)DATA = GetDataFromFig(a);Clusters = getappdata(DATA.toplevel,'Clusters');if strcmp(id,'zoom')    xl = get(gca,'xlim');    bt = strmatch(get(gcf,'SelectionType'),{'normal' 'alternate'  'extend'  'open'});    if bt == 2        xl(1) = xl(1)*2;        xl(2) = xl(2)*2;    else        xl(1) = xl(1)/2;        xl(2) = xl(2)/2;    end    set(gca,'xlim',xl);    return;enda = cells(1);b = cells(2);if ex > 0C = Clusters{ex};sync = DATA.synci{ex};xc = sync.ccf{cells(1),cells(2)};else   [xc, synci, allxc] = PC.meanccf(DATA, id,a,b);   si = PC.SyncIndices(xc);   fprintf('synci %s: %.2f->%.2f\n',sprintf(' %.2f',synci(:,1)),mean(synci(:,1)),si(1));endPC.SetFigure(DATA,DATA.tag.onecell);midpt = ceil(length(xc))./2;hold off;if length(id) > 1    plot(allxc');    hold on;    plot(xc,'k','linewidth',2);elseplot(xc);endset(gca,'ylim',[0 max(xc)]);if ex > 0    title(sprintf('Ex%d P%d (%.1f),%d (%.1f)',ex,cells(1),C{a}.mahal(1),cells(2),C{b}.mahal(1)));else    title(sprintf('%d Expts, P %d,%d',length(id),cells(1),cells(2)));end%xc = xcorrtimes(C{cells(1)}.times,C{cells(2)}.times);%plot(xc);