function KeyPressed(src, ks, fcn)      if strcmp(ks.Key, 'control')          setappdata(0,'control_is_down',1);          return;      elseif strcmp(ks.Key,{'alt'})          setappdata(0,'alt_is_down',1);          return;      elseif sum(strcmp(ks.Key,{'shift' 'control' 'alt'}))          return;      endDATA = GetDataFromFig(src);tag = get(src,'tag');figtag = get(gcf,'tag');bt = strmatch(get(gcf,'SelectionType'),{'normal' 'alternate'  'extend'  'open'});%Shift up/down saves any cut cluster, set the currecnt cell, then moves onif sum(strcmp(ks.Key,{'uparrow' 'downarrow'})) & strcmp(ks.Modifier,'shift')    if DATA.NewCut.saved == 0        DATA = PC.SaveCluster(DATA, DATA.currentpoint,1);    end    DATA = PC.AddKey(DATA,figtag);endif strmatch(ks.Key,{'delete' 'backspace'})     if fcn == 2 % delete box marking cell on template track plot        DATA.usepeaks(DATA.currentpoint(1)) = 0;        if ishandle(DATA.markcc)            delete(DATA.markcc)        end        h = PC.DrawBox(DATA.currentpoint(1),DATA.currentpoint(2),2);        set(h,'color','r');        if strcmp(ks.Modifier,'shift')            eid = find(DATA.usepeaks > 0);            for j = 1:length(eid)                h = PC.DrawBox(eid(j),DATA.usepeaks(eid(j)),'color','r');            end            DATA.usepeaks = zeros(size(DATA.usepeaks));        end    elseif fcn == 3  || strcmp(fcn,'duplicates') %delete current location from CellList        it = findobj(src,'Tag','CellNumberId');        if length(it) == 1            cellid = get(it,'value');            DATA.selectprobe(DATA.currentpoint(1),DATA.currentpoint(2)) = 1;            [a,b] = find(DATA.selectprobe);            for j  = 1:length(a)                id = find(ismember(DATA.CellList(a(j),b(j),:),cellid));                if length(id) == 1                    DATA.cellcluster = id;                    DATA = PC.DeleteCell(DATA, a(j), b(j), DATA.cellcluster);                elseif isfield(DATA,'muCellList') && size(DATA.muCellList,2) >= b(j)                    DATA = PC.DeleteCell(DATA, a(j), b(j), DATA.cellcluster);                end            end            PC.SaveCellList(DATA);        end        DATA = PC.PlotCellList(DATA,'showfig','calltag',fcn);    endelseif strcmp(ks.Key,'add') | ks.Character == '+'    DATA = PC.AddKey(DATA,figtag);    elseif strmatch(ks.Key,'rightarrow')    DATA = PC.NextButton(src, ks, 'r');elseif strmatch(ks.Key,'leftarrow')    DATA = PC.NextButton(src, ks, 'l');elseif strcmp(ks.Key,'downarrow')    DATA =  PC.NextButton(src, ks, 'd');elseif strmatch(ks.Key,'uparrow')    DATA = PC.NextButton(src, ks, 'u');    n =1;elseif strmatch(ks.Key,'f')    DATA = PC.FlipLineCrit(DATA);elseif strmatch(ks.Key,'q')    DATA = PC.SaveCluster(DATA, DATA.currentpoint, 1);elseif strmatch(ks.Key,'add')elseif strmatch(ks.Key,'subtract')elseif strmatch(ks.Key,'space')endset(DATA.toplevel,'UserData',DATA);    if strcmp(tag,DATA.tag.celllist) && bt == 1        figure(src);    end    