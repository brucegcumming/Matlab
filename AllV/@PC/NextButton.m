function DATA = NextButton(mn,b, dir)    DATA = GetDataFromFig(mn);   nex = length(DATA.strings);if dir == 'r' %step 1 rihgt    if DATA.currentpoint(2) < DATA.nprobes    DATA.currentpoint(2) = DATA.currentpoint(2)+1;    else        DATA.currentpoint(2) = 1;        if DATA.currentpoint(1) < nex            DATA.currentpoint(1) = DATA.currentpoint(1)+1;        end    end    DATA = PC.ClearSelections(DATA,0,0);elseif dir == 'l' %step 1 left    if DATA.currentpoint(2) > 1    DATA.currentpoint(2) = DATA.currentpoint(2)-1;    else        DATA.currentpoint(2) = DATA.nprobes;        if DATA.currentpoint(1) > 1        DATA.currentpoint(1) = DATA.currentpoint(1)-1;        end    end    DATA = PC.ClearSelections(DATA,0,0);elseif dir == 'd' %step 1 down - if looking at Templatesscores, step trough these    if isfield(DATA,'usepeaks') && DATA.steptype ==2        if DATA.currentpoint(1) < nex            j = DATA.currentpoint(1)+1;            id = find(DATA.usepeaks(j:end) > 0);            if ~isempty(id)                j = DATA.currentpoint(1)+id(1);                DATA.currentpoint(1) = j;                DATA.currentpoint(2) = DATA.usepeaks(j);            end        else            id = find(DATA.usepeaks> 0);            if ~isempty(id)                DATA.currentpoint(1) = id(1);            end        end    else        if DATA.currentpoint(1) < nex            DATA.currentpoint(1) = DATA.currentpoint(1)+1;        else            DATA.currentpoint(1) = nex;            DATA.currentpoint(2) = DATA.currentpoint(2)+1;        end    end                elseif dir == 'u' %step 1 up    if isfield(DATA,'usepeaks') && DATA.steptype ==2        if DATA.currentpoint(1) > 1            j = DATA.currentpoint(1)-1;            id = find(DATA.usepeaks(1:j) > 0);            if ~isempty(id)                DATA.currentpoint(1) = id(end);                DATA.currentpoint(2) = DATA.usepeaks(id(end));            end        else            id = find(DATA.usepeaks> 0);            if ~isempty(id)                DATA.currentpoint(1) = id(1);            else                DATA.currentpoint(1) = 1;            end        end    else        if DATA.currentpoint(1) > 1    DATA.currentpoint(1) = DATA.currentpoint(1)-1;    else        DATA.currentpoint(1) = 1;        if DATA.currentpoint(2) > 1            DATA.currentpoint(2) = DATA.currentpoint(2)-1;        end        end    end    DATA = PC.ClearSelections(DATA,0,0);endDATA = PC.ShowData(DATA,DATA.currentpoint(1),DATA.currentpoint(2),'oneprobe');if DATA.plot.allxy    PC.PlotAllProbeXY(DATA);    drawnow;endif ismember(dir,'ud')  %moving expts up and down with arrow keys, spoole/show all probes    e = DATA.currentpoint(1);    PC.PrintComments(DATA,e,1:DATA.nprobes);    if DATA.spoolspikes        PC.PlotAllProbe(DATA,'spoolall');    elseif DATA.show.watchexptallspks        PC.PlotAllProbe(DATA,'allspks');    end    DATA = PC.ClearSelections(DATA, 0, 0);    str = sprintf('Ex %.1f: %s',DATA.exptid(DATA.currentpoint(1)),DATA.expnames{DATA.currentpoint(1)});    fprintf('%s\n',str);    PC.SetFigure(DATA, DATA.tag.all);    title(str);    Expts = getappdata(DATA.toplevel,'Expts');    DATA.Expt = Expts{e};    PC.SetTrialList(DATA,{},DATA.currenttrial);endstopped = 0;set(DATA.toplevel,'UserData',DATA);