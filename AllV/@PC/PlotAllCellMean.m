function PlotAllCellMean(DATA, type)    Clusters = getappdata(DATA.toplevel,'Clusters');    it = findobj('Tag','CellNumberId');    cellid = get(it,'value');    id = find(DATA.CellList == cellid);    [eid, cid, clid] = ind2sub(size(DATA.CellList),id);    [eid, id] = sort(eid);    cid = cid(id);    clid = clid(id);    exptnos = DATA.CellDetails.exptids(eid);    eid = find(ismember(DATA.exptid,exptnos)); %now a list of members of Clusters;    [nr,nc] = Nsubplots(length(eid));    PC.SetFigure(DATA,DATA.tag.allmean);    subplot(1,1,1);    for j = 1:length(eid)        mysubplot(nr,nc,j);        hold off;         PC.PlotMeanSpike(Clusters{eid(j)}{cid(j)},cid(j),clid(j),type,DATA);        set(gca,'Xtick',[],'Ytick',[]);        axdata.toplevel = DATA.toplevel;        axdata.eid = eid(j);        axdata.probe = cid(j);        set(gca,'UserData',axdata,'uicontextmenu',PC.AddContextMenu(gca,'subplot'));        h = get(gca,'title');        xl = get(gca,'xlim');        yl = get(gca,'ylim');        a = get(h,'position');        a(2) = yl(2);        a(1) = mean(xl);        set(h,'position',a,'VerticalAlignment','top');        set(gca,'ButtonDownFcn',{@PC.HitXYPlot, eid(j), cid(j)});        c = get(gca,'Children');        for k = 1:length(c)            set(c(k),'ButtonDownFcn',{@PC.HitXYPlot, eid(j), cid(j)});        end        d = PC.DistanceMeasure(Clusters{eid(j)}{cid(j)},1,DATA.mahaltype);        h = text(xl(2),yl(1),sprintf('E%dP%d/%d:%.2f %s',eid(j),cid(j),clid(j),d,DATA.expnames{eid(j)}),'horizontalalignment','right','verticalalignment','bottom');        if d < DATA.crit.mahal            set(h,'color','r');        end        if j == 1            title(sprintf('Cell%d',cellid));        end    end