function result = PlotClusterHistogram(DATA, C, refit, varargin)    j = 1;    cl = 1;    while j <= length(varargin)        if strncmpi(varargin{j},'cluster',5)            j =j+1;            cl = varargin{j};        end        j = j+1;    end    ex = C.exptid;    p = C.probe;    if cl > 1 && cl <= length(C.next)+1 && isfield(C.next{cl-1},'xy')        X = C;        C = C.next{cl-1};        C.clst = X.clst;        C.exptid = X.exptid;    end    if DATA.plot.gmfit    GMfits = getappdata(DATA.toplevel,'GMfits');    [x, nsp] = PC.PlotHist(C.xy,C,GMfits);    else        [x, nsp] = PC.PlotHist(C.xy,C);    end    result.x = x;    result.nsp = nsp;    hold on;    scale = trapz(x,nsp);    if isfield(C,'fitdpparams') && refit ==0        fits{1}.params = C.fitdpparams(1,:);        fits{2}.params = C.fitdpparams(2,:);        dp = abs(C.fitdprime(1));        c.fitpos = C.fitdprime(2:3);        c.diff = abs(fits{1}.params(1)-fits{2}.params(1));        c.sd = sqrt((fits{1}.params(2).^2+fits{2}.params(2).^2)/2);    else        [dp, fits,c] = PC.Fit2Gauss(C,200);    end    if sum(c.fitpos) == 2        qstr = [];    else        qstr = '*';    end    result.qstr = qstr;    if C.shape == 0        b.gxy(:,1) = linspace(min(x),max(x),100);    elseif DATA.plot.gmfit && isfield(GMfits{ex}{p},'gmfit1d')         [a,b] = GMDip(C.xy,GMfits{ex}{p}.gmfit1d);        plot(b.gxy(:,1),b.gxy(:,2).*scale,'g');        plot(b.gxy(:,1),b.gxy(:,3).*scale,'g');        plot(b.gxy(:,1),sum(b.gxy(:,[2 3]),2).*scale,'r');        gmsd = sqrt(mean(b.G.Sigma));        fprintf('Diffs %.2f,%.2f, Sds %.2f %.2f\n',abs(diff(b.G.mu)),c.diff,gmsd,c.sd)        plot([C.crit(1) C.crit(1)],[0 max(nsp)],'r');    else        b.gxy(:,1) = linspace(min(C.xy(:,1)),max(C.xy(:,1)));        gmsd = NaN;        plot([C.crit(1) C.crit(1)],[0 max(nsp)],'r');    end        if ~isnan(dp)%     fx = linspace(min(C.xy(:,1)),max(C.xy(:,1)),200);    fya = FitGauss(b.gxy(:,1), fits{1}.params, 'eval');    fyb = FitGauss(b.gxy(:,1), fits{2}.params, 'eval');    yl = get(gca,'ylim');    plot(b.gxy(:,1),fya,'m-','linewidth',2);    plot(b.gxy(:,1),fyb,'c-','linewidth',2);    set(gca,'ylim',yl);    end    title(sprintf('%d/%d events M%.2f From Fit %.2f%s',C.ncut,size(C.xy,1),C.mahal(4),dp,qstr));