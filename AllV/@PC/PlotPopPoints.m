function [handles, details] = PlotPopPoints(X,Y, varargin)j = 1;colorscheme = 'none';shapelist = [];include = ones(size(X));while j <= length(varargin)    if isstruct(varargin{j})        DATA = varargin{j};    elseif strncmpi(varargin{j},'exclude',6)        j = j+1;        if strcmp(varargin{j},'offpeak') %trigger chan not biggest in mean            id = find(abs(DATA.peakdiff) > 0);            include(id) = 0;        end    elseif strncmpi(varargin{j},'colors',6)        j = j+1;        colorscheme = varargin{j};    elseif strncmpi(varargin{j},'includelist',10)        j = j+1;        include = varargin{j};    elseif strncmpi(varargin{j},'shapes',6)        j = j+1;        shapelist = varargin{j};    end    j = j+1;end    colors = mycolors;types = 1;if isnumeric(colorscheme)    types = colorscheme;    c = abs(colorscheme);    fill = 1-sign(colorscheme);elseif strmatch(colorscheme,'probe')    colors = mycolors('ncol',24);    c = repmat([1:size(X,2)],size(X,1),1);    fill = zeros(size(c));elseif strmatch(colorscheme,'expt')    colors = mycolors('ncol',size(X,1));    c = repmat([1:size(X,1)]',1,size(X,2));    fill = zeros(size(c));elseif strmatch(colorscheme,'cutspace')    c = DATA.cutspace;    fill = zeros(size(c));else    c = ones(size(X));    fill = zeros(size(c));endtypelist = unique(types);hold off;np = 0;for j = 1:size(X,1)    for k = 1:size(X,2)        if include(j,k)            if isempty(shapelist)                shape = 'o';            else                shape = shapelist(j,k);            end        h = plot(X(j,k),Y(j,k),shape,'buttondownfcn',{@PC.HitPopPoint, j,k},'color',colors{c(j,k)});        np = np+1;        if fill(j,k)            set(h,'markerfacecolor',colors{c(j,k)});        end        if length(types) > 1            type = find(types(j,k) == typelist);            handles(type) = h;        else            handles(1) = h;        end        hold on;        end    endenddetails.np = np;