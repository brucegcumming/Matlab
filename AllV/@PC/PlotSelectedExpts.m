function [Expt, AllExpt] = PlotSelectedExpts(DATA, varargin)%PlotSelectedExpts(DATA, ...)%PlotSelectedExpts(DATA, ...)    Expt = [];    AllExpt = [];    if strncmpi(DATA.plotexpttype,'none',4)        DATA.plotexpttype = 'rcmeans';    end    args = {};    exid = [];    pid = [];    usedefault = 0;    cellid = 0;    colors = mycolors;    clusterid = 1;    linestyles = {'-' '--' ':' '.-' '-' '--' ':' '.-'};    j = 1;    while j <= length(varargin)        if strncmpi(varargin{j},'cell',6)            j = j+1;            cellid = varargin{j};        elseif strncmpi(varargin{j},'cluster',6)            j = j+1;            clusterid = varargin{j};        elseif strncmpi(varargin{j},'colors',6)            j = j+1;            colors = varargin{j};        elseif strncmpi(varargin{j},'default',6)            usedefault = 1;            clusterid = DATA.currentcluster;            if strcmp(DATA.plotexpttype,'none')                Expt = DATA.Expt;                return;            end        elseif strncmpi(varargin{j},'expts',6)            j = j+1;            exid = varargin{j};            j = j+1;            pid = varargin{j};        else            args = {args{:} varargin{j}};        end        j = j+1;    end        if usedefault        PC.SetFigure(DATA, DATA.tag.expt);    end        if isempty(exid)    [exid, pid] = find(DATA.selectprobe);    end    Clusters = PC.CheckClusterLoaded(DATA,exid);    Expts = getappdata(DATA.toplevel,'Expts');    lastf = gcf;    if length(clusterid) == 1        clusterid = ones(size(exid)).* clusterid;    end    h = [];    for j = 1:length(exid)        args = {};        Expt = PC.CountExptSpikes(DATA, Expts{exid(j)},Clusters{exid(j)}{pid(j)},clusterid(j));        if strncmp(Expt.Header.expname,'image.orXob',11)            args = {args{:}};        end        if Expt.Header.rc            if strncmpi(DATA.plotexpttype,'rcmeans',4)                args = {args{:} 'condense'};            else                args = {args{:} 'rcnmin' 10 'sdfw' 100};            end        end        if j == 1            res{j} = PlotExpt(Expt,'forcecolor',colors{j},args{:});        else            res{j} = PlotExpt(Expt,'forcecolor',colors{j},args{:},'holdon');        end        if isfield(res{j},'delaysamples') %an RC expt            [a,b,c] = PlotRC(res{j},'bestdelay');            figure(lastf);            for k = 1:size(b,2)                eh(k) = plot(a(:,k),b(:,k),'o-','color',colors{j},'linestyle',linestyles{k});                hold on;            end            Expt.handles = eh;        else            Expt.handles = res{j}(1).allhandles;        end        Expt.handles = Expt.handles(ishandle(Expt.handles));        set(Expt.handles,'buttondownfcn',{@PC.HitPopPoint, exid(j), pid(j), cellid});        h(j) = Expt.handles(1);        labels{j} = sprintf('E%dP%d',exid(j),pid(j));        AllExpt{j} = Expt;        hold on;    end    if length(h)        mylegend(h,labels);    endif usedefault    DATA.Expt = Expt;    set(DATA.toplevel,'UserData',DATA);end