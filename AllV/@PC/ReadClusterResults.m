function [DATA, Clusters] = ReadClusterResults(DATA, Clusters)if DATA.datatype == 2    DATA = PC.ReadTemplateResults(DATA, DATA.templatesrc);    return;end%if AutoClusters were loaded, check these toouseauto = isappdata(DATA.toplevel,'AutoClusters');if useauto    AutoClusters = getappdata(DATA.toplevel,'AutoClusters');    for j = 1:length(AutoClusters)    endendctimes = CellToMat(Clusters{1},'ctime');lastc.ctime = max(ctimes);for j = 1:length(Clusters)    %first make sure required fields are present    for k = 1:length(Clusters{j})        if ~isfield(Clusters{j}{k},'mahal') || length(Clusters{j}{k}.mahal) < 4             Clusters{j}{k}.mahal(4) =0;        end        if ~isfield(Clusters{j}{k},'quick')            Clusters{j}{k}.quick =0;        end        if ~isfield(Clusters{j}{k},'MeanSpike')            Clusters{j}{k}.MeanSpike = [];        end                    if ~isfield(Clusters{j}{k},'Evec')            Clusters{j}{k}.Evec.Eval = NaN;        end        if ~isfield(Clusters{j}{k},'probe')            Clusters{j}{k}.probe = k;        end        if ~isfield(Clusters{j}{k},'bsetspace')            Clusters{j}{k}.bestspace = [NaN 0];        end        if isfield(Clusters{j}{k},'gmfit') && isempty(Clusters{j}{k}.gmfit)            Clusters{j}{k} = rmfield(Clusters{j}{k},'gmfit');        end        Clusters{j}{k}.exptid = j;        for c = 1:length(Clusters{j}{k}.next)            if isfield(Clusters{j}{k}.next{c},'space')                Clusters{j}{k}.next{c}.exptid = j;            end        end        if ~isfield(Clusters{j}{k},'space')            Clusters{j}{k}.quick = NaN;        end        if useauto && j <= length(AutoClusters)            AutoClusters{j}{k}.exptid = j;        end    end    %then read values wanted in data    DATA = PC.ReadClustersIntoData(DATA,Clusters{j},j);endeid = CellToMat(Clusters,'exptid');exptno = CellToMat(Clusters,'exptno');exptno = exptno(:,1);[a,b] = find(eid ==0);for j = 1:length(a)    DATA = PC.AddError(DATA,'Cluster E%d(id%d)P%d exptid = 0!!!!!',exptno(a(j)),a(j),b(j));    Clusters{a(j)}{b(j)}.exptid = a(j);endpid = CellToMat(Clusters,'probe');[a,b] = find(pid ==0);for j = 1:length(a)    fprintf('Cluster E%dP%d probe = 0!!!!!\n',a(j),b(j));    Clusters{a(j)}{b(j)}.probe = b(j);endsetappdata(DATA.toplevel,'Clusters',Clusters);if useauto    setappdata(DATA.toplevel,'AutoClusters',AutoClusters);end   Expts = getappdata(DATA.toplevel,'Expts');Expts = PC.SetExptTimeOffset(Expts);setappdata(DATA.toplevel,'Expts',Expts);