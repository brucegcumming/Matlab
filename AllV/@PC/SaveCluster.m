function DATA = SaveCluster(DATA, pt, quick, varargin)    e = pt(1);    p = pt(2);    EClusters = getappdata(DATA.toplevel,'Clusters');    deleted = 0;        e = DATA.currentpoint(1);    p = DATA.currentpoint(2);    C = EClusters{e}{p};    ex = C.exptno;%if saved == -1, means a cluster was deleted    if DATA.NewCut.saved >= 0 && DATA.NewCut.probe > 0        C = DATA.NewCut;    else        mycprintf('red','Saving - but no new cluster\n');    end    if rem(ex,1) > 0.001        xs = 'a';    else        xs = '';    end    cfile = [DATA.name '/Expt'  num2str(floor(ex)) xs 'ClusterTimes.mat'];    afile = [DATA.name '/Expt'  num2str(floor(ex)) xs 'AutoClusterTimes.mat'];    if exist(cfile,'file')        load(cfile);    elseif exist(afile,'file')        load(afile);        for j = 1:length(Clusters)            Clusters{j}.auto = 1;        end    end    dfile = [DATA.name '/Expt'  num2str(floor(ex)) xs 'ClusterTimesDetails.mat'];    if quick == 0        if exist(dfile)            load(dfile);        else            ClusterDetails = {};        end        afile = [DATA.name '/Expt'  num2str(floor(ex)) xs 'AutoClusterTimesDetails.mat'];        if exist(afile)            a = load(afile);            for j = 1:length(a.ClusterDetails)                if j > length(ClusterDetails) || isempty(ClusterDetails{j}) || ~isfield(ClusterDetails{j},'t')                    ClusterDetails{j} = a.ClusterDetails{j};                end            end        end        ClusterDetails{p}.clst = C.clst;    end%first delete any clusters from Clusterdetails if they have been removed in PloctClusters        for j = 1:length(C.next)        if isempty(C.next{j}) && isfield(C,'deleted') && C.deleted(j+1) > 0            ClusterDetails{p}.next{j} = [];            Clusters{p}.next{j} = [];            deleted = deleted+1;        end    end    %C.xy should no longer be changed by plotclusters, so don't save it out    %Need modify disk file (Clusters) and the version in memory now (EClusters)    %Because PC.PlotClusters adds fields that we don't want save out, easiest    %thing is just to make changes separatley, not copy one to anaother    if C.cluster > 1        n = C.cluster-1;        if ~isfield(C.next{n},'space') %new cluster - cut in same space as 1            C.next{n}.space = C.space;        end        if ~isfield(C.next{n},'xy')            C.next{n}.xy = C.xy;        end        C.next{n}.ctime = now;        C.next{n}.savetime = now;        if n > length(EClusters{e}{p}.next)            EClusters{e}{p}.next{n} = {};        end        EClusters{e}{p}.next{n} = CopyFields(EClusters{e}{p}.next{n},C.next{n},...                'shape','crit','xyr','sign','angle','savetime','times','space','ctime','savetime','clst');        Clusters{p}.next{n} = CopyFields(EClusters{e}{p}.next{n},C.next{n},...            'shape','crit','xyr','sign','angle','savetime','times','space','ctime','savetime');        %C.times is from ClusterDetails.t        Clusters{p}.next{n}.times = C.t(C.clst == C.cluster+1);        Clusters{p}.next{n}.clusterprog = sprintf('PlotClusters V %.2f',DATA.version);        Clusters{p}.next{n}.manual = 2;        Clusters{p}.next{n}.pos = C.next{n}.pos;        Clusters{p}.next{n}.aspectratio = C.next{n}.aspectratio;        if quick == 0            if n > length(ClusterDetails{p}.next)                ClusterDetails{p}.next{n} = {};            end            ClusterDetails{p}.next{n}.xy = C.xy;            if C.shape > 0                ClusterDetails{p}.next{n}.xy = xyrotate(C.next{n}.xy(:,1),C.next{n}.xy(:,2),C.next{n}.angle);            end        end    else        ClusterDetails{p}.xy = xyrotate(C.xy(:,1),C.xy(:,2),C.angle);        Clusters{p}.shape = C.shape;        Clusters{p}.crit = C.crit;        Clusters{p}.xyr = C.xyr;        Clusters{p}.angle = C.angle;        Clusters{p}.sign = C.sign;        Clusters{p}.ctime = C.ctime;        if isfield(C,'t')            Clusters{p}.times = C.t(C.clst == 2);            C.times = C.t;        else            Clusters{p}.times = C.times(C.clst == 2);        end        Clusters{p}.savetime(1) = now;        EClusters{e}{p} = CopyFields(EClusters{e}{p},C,...            'shape','crit','xyr','sign','angle','savetime','times','clst');        Clusters{p}.clusterprog = sprintf('PlotClusters V %.2f',DATA.version);        Clusters{p}.aspectratio = C.aspectratio;        Clusters{p}.manual = 2;    end    setappdata(DATA.toplevel,'Clusters',EClusters);    testing = 0;    if testing        ofile = strrep(cfile,'ClusterTimes','NewClusterTimes');    else        ofile = cfile;    end    if isempty(Clusters{p})        Clusters{p} = rmfield(C,{'xy' 'clst' 'Evec'});        for j = 1:length(Clusters{p}.next)            Clusters{p}.next{j} = rmfields(Clusters{p}.next{j},'xy');        end    end    fprintf('Saving %s\n',ofile);    BackupFile(ofile);    if exist('FullVData')        save(ofile,'-v7.3','Clusters','FullVData');    else        fprintf('No FullVData for %s\n',ofile);        save(ofile,'-v7.3','Clusters');    end    if testing        ofile = strrep(dfile,'ClusterTimes','NewClusterTimes');    else        ofile = dfile;    end    if quick == 0        BackupFile(ofile);        if length(ClusterDetails{p}.clst) == length(ClusterDetails{p}.t)            save(ofile,'-v7.3','ClusterDetails');        else            fprintf('E%d P%d Can''t Save ClusterDetails: size mismatch',C.exptid,C.probe(1));            errordlg(sprintf('Can''t Save ClusterDetails: size mismatch','ClusterError','modal'));        end    end    fprintf('Saved Cluster for probe %d Expt %d\n',p,ex);    DATA.NewCut.saved = 1;