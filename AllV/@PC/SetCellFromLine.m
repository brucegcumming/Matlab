function SetCellFromLine(a,b, cluster, cell, varargin)cellargs = {};j = 1;    while j <= length(varargin)        if strncmpi(varargin{j},'muonly',5)            cellargs = {cellargs{:} varargin{j}};        end        j = j+1;    end    axdata = get(gca,'UserData');    if ~isfield(axdata,'clnum') || isempty(axdata.clnum)        axdata.clnum = 1;    end    if cluster == 0 && axdata.clnum > 0        cluster = axdata.clnum;     end    if isfield(axdata,'toplevel;')    DATA = get(axdata.toplevel,'UserData');    else    DATA = GetDataFromFig(a);    end    if strcmp(cell,'optimize')        Clusters = getappdata(DATA.toplevel,'Clusters');        DATA.cluster = Clusters{axdata.eid}{axdata.probe};        C = OptimizeCluster(DATA);        Clusters{axdata.eid}{axdata.probe} = C;        PC.SetFigure(DATA,DATA.tag.xyplot); hold off;        PC.PlotClusterXY(DATA,C,'shorttitle','tight');        return;    elseif strncmp(cell,'cellrates',7)        PC.PlotClusterRates(DATA, 'rateseqone');        return;    elseif strncmp(cell,'allxy',5) || strncmp(cell,'allspk',6)        DATA.currentpoint(1) = axdata.eid;        DATA.currentpoint(2) = axdata.probe;        if strcmp(cell,'allxyprobe')            DATA = PC.PlotExptsProbe(DATA, 'AllprobeXY');        elseif strcmp(cell,'allxyexpt')            DATA = PC.PlotAllProbeXY(DATA, 'AllexptXY');        elseif strcmp(cell,'allxycell')            PC.PlotAllCellXY(DATA);%            DATA = PC.PlotAllProbeXY(DATA, 'AllCellXY');        elseif strcmp(cell,'allspkscell')            PC.PlotAllCell(DATA, 'allspks');        elseif strcmp(cell,'allspksexpt')            DATA = PC.PlotAllProbe(DATA, 'allspks');        elseif strcmp(cell,'allspksprobe')            DATA = PC.PlotAllProbe(DATA, 'allprobespks');        end        set(DATA.toplevel,'UserData',DATA);        return;    elseif strcmp(cell,'duplicate')        xc = getappdata(DATA.toplevel,'xcCellList');        a = cluster;        cluster = xc(a).cl;        axdata.probe = xc(a).p;        cell = -axdata.cell;    elseif strcmp(cell,'spoolauto')        PC.SpoolSpikes(DATA, [axdata.eid axdata.probe],'auto');        return;    elseif strcmp(cell,'spool')        PC.SpoolSpikes(DATA, [axdata.eid axdata.probe]);        return;    elseif strcmp(cell,'findduplicate')        PC.FindDuplicates(DATA, [axdata.eid axdata.probe axdata.clnum]);        return;    elseif sum(strcmp(cell,{'getfullv' 'refcut' 'lastcut' 'forcefullv'}))        PC.CallAllVPcs(DATA, axdata.eid, axdata.probe,cell)        return;    end    if sum(DATA.selectprobe(:) >0) > 1        Clusters = getappdata(DATA.toplevel,'Clusters');        [a,b] = find(DATA.selectprobe > 0);        for j = 1:length(a)            DATA = PC.SetCellEntry(DATA, Clusters{a(j)}{b(j)}, a(j),b(j),cluster, cell,'nosave',cellargs{:});        end        PC.SaveCellList(DATA);    else        DATA = PC.SetCellEntry(DATA, [], axdata.eid,axdata.probe,cluster, cell, varargin{:});    end    DATA.currentpoint(2) = axdata.probe;    if isfield(axdata,'celllabels') && ishandle(axdata.celllabels)        delete(axdata.celllabels);        axdata.celllabels = PC.AddCellLabels(DATA, axdata.eid, axdata.probe);        set(gca,'UserData',axdata);    end    DATA = PC.PlotCellList(DATA,'showfig');    set(DATA.toplevel,'UserData',DATA);