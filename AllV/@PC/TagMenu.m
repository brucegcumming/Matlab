function TagMenu(a, b, fcn)    DATA = GetDataFromFig(a);    DATA.currentprobe = DATA.currentpoint(2);    DATA.exptno = DATA.exptid(DATA.currentpoint(1));    set(DATA.toplevel,'UserData',DATA);    if strcmp(fcn,'comment')        PlotComments(DATA.datadir,'parent',DATA.toplevel);    return;    end    if strcmp(fcn,'flipline')        PC.FlipLineCrit(DATA);    return;    end    if sum(strcmp(fcn,{'poor isolation' 'dropping spikes' 'poor stability'}))        PlotComments(DATA.datadir,DATA,'addhidden',fcn);        return;    end    reason = strmatch(fcn,{'?cell' 'morecells' 'threshold' 'improve' 'error', 'comment' 'poor stability' 'poor isolation' 'dropping spikes' 'clear' 'print'});    if isempty(reason)        reason = NaN;    end        DATA = LoadComments(DATA,DATA.name);    if reason == 10 %clear        DATA.selectprobe = zeros(size(DATA.selectprobe));        reason = 0;    elseif reason == 11 %print        [a,b] = find(DATA.tagged > 0);        for j = 1:length(a)            fprintf('E%.1fP%d %s\n',a(j),b(j),DATA.tagstrings{DATA.tagged(a(j),b(j))});        end        reason = 0;    end    if ~isfield(DATA,'selectprobe')        DATA.selectprobe = zeros(length(DATA.exptid),DATA.nprobes);    end    if ~isfield(DATA,'tagged')        DATA.tagged = zeros(size(DATA.selectprobe));    end    id = find(DATA.selectprobe > 0);    if reason < 6        DATA.tagged(id) =  reason;        DATA.tagged(DATA.currentpoint(1),DATA.currentpoint(2)) =  reason;    end    [a,b] = ind2sub(size(DATA.selectprobe),id);    if isempty(id)        fprintf('No Probes/Expts Selected\n');    end    for j = 1:length(id)         if  reason== 6            PC.GetComment(DATA,a(j),b(j));        elseif ismember(reason, [7 8 9])            PC.AddComment(DATA, [], fcn);            DATA = get(DATA.toplevel,'UserData');        elseif reason == 1            DATA.CellList(DATA.currentpoint(1),DATA.currentpoint(2),:) = -100;            PC.PlotCellList(DATA);        end        fprintf('Tagging E%d,P%d\n',a(j),b(j));    end       if strcmp(DATA.plot.alltype,'Tagged')        PC.PlotAllClusters(DATA,[]);    end    SaveComments(DATA, DATA.name);    set(DATA.toplevel,'UserData',DATA);