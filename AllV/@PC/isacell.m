function [true, cellid, clid] = isacell(DATA, row, p, clid)%[true, cellid, clid] = isacell(DATA, row, p, clid)%True = there is cell defined on this row,probe        cellid = 0;        if isfield(row,'p')            cell = row;            p = cell.p;            if isfield(cell,'eid')                row = cell.eid;            else                row = DATA.currentpoint(1);            end            clid = cell.cl;        elseif nargin > 3            if clid <= size(DATA.CellList,3)                cellid = DATA.CellList(row,p,clid);            else                cellid = 0;            end            true = cellid > 0;            return;        elseif rem(p,1) > 0            clid = round(rem(p,1) .* 10);            p = floor(p);        else            clid = 0;        end        true = sum(DATA.CellList(row,p,:) > 0);        true = sum(true);        dup = DATA.CellList(row,p,:) < 0;        if true %if spefified a cl, only report cell value for this            if clid > 0                 if length(p) > 1                    if length(row) == 1                        row = ones(size(p)).*row;                    end                    if max(clid) > size(DATA.CellList,3)                        DATA.CellList(:,:,max(clid)) = 0;                    end                    id = sub2ind(size(DATA.CellList),row,p,clid);                    cellid = DATA.CellList(id);                elseif size(DATA.CellList,3) >= clid                    cellid = DATA.CellList(row,p,clid);                else                    cellid = 0;                end            else                                cellid = DATA.CellList(row,p,:);                clid = find(cellid > 0);                cellid = cellid(cellid>0);            end        end                