function DATA = ClassifyAndFit(DATA)    oldname = get(DATA.toplevel,'Name');    set(DATA.toplevel,'Name','Classifying...');    DataClusters = AllV.mygetappdata(DATA,'Clusters');    drawnow;    if isfield(DATA.cluster,'sign') && abs(DATA.cluster.sign) == 1        [cl, DATA.cluster, DATA.xy{DATA.currentcluster}] = AllV.ClassifySpikes(DATA, DATA.cluster,'sign',DATA.cluster.sign);    else        [cl, DATA.cluster, DATA.xy{DATA.currentcluster}] = AllV.ClassifySpikes(DATA, DATA.cluster);    end    if length(cl.id)        DATA.MeanSpike = cl.MeanSpike;    end    DataClusters{DATA.probe(1)} = DATA.cluster;    DataClusters{DATA.probe(1)}.times = DATA.t(cl.id);    DATA = AllV.mysetappdata(DATA,'Clusters',DataClusters);    DATA.plottype = AllV.WhichPlotType(DATA.cluster, DATA.currentcluster);    c = AllV.PlotHistogram(DATA, []);    if DATA.cluster.mahal(4) < 0.001        DATA.cluster.mahal(4) = c.gmdprime;    end    if DATA.checkclusters    AllV.CheckClusters(DataClusters, 'CheckNexts','Classify');    AllV.CheckClusters(DataClusters,'CheckFitSpace');    end    set(DATA.toplevel,'UserData',DATA);    set(DATA.toplevel,'Name',oldname);    drawnow;    