function SpoolAllSpikes(DATA, varargin)    j = 1;    while j <= length(varargin)        if strncmpi(varargin{j},'front',3)            AllV.SetFigure(DATA.tag.spikes, DATA,'front');        end                    j = j+1;    endAllV.SetTrialList(DATA);DataClusters = AllV.mygetappdata(DATA,'Clusters');DATA.vsep = 4;np = DATA.nprobes;if isempty(DATA.trigtimes) || sum(DATA.trigcheck) <np    [DATA, DataClusters] = AllV.LoadTrigTimes(DATA, 1:np);endDATA.selectprobe = zeros(1,1:DATA.nprobes);hold off;plot(0,0,'w.');hold on;set(gca,'Position',[0.05 0.05 0.9 0.9]);set(gca,'ButtonDownFcn',@AllV.SpikeButtonPressed);npts = length(DATA.spts);nc = 2;DATA.handles = zeros(DATA.nprobes,2);for p = 1:DATA.nprobes    %nc = length(unique(DataClusters{p}.clst));    DATA.handles(p,1) = plot([-8 32],[0 0], 'color',[0.5 0.5 0.5]);        DATA.handles(p,2) = plot([-8 32],[0 0], 'color','r');    if ~isfield(DataClusters{p},'auto')        DataClusters{p}.auto = 1;    end    if DataClusters{p}.auto == 1 & AllV.BadCluster(DataClusters{p})        set(DATA.handles(p,2),'color','b');    elseif DataClusters{p}.auto ==1        set(DATA.handles(p,2),'color',[0.8 0 0]);    end    if isfield(DataClusters{p},'xtimes')        nx = length(DataClusters{p}.xtimes)        for j = 1:nx            DATA.handles(p,j+2) = plot([-8 32],[0 0], 'color','g');        end    end    xoff = floor((p-1)/6) .* npts;    yoff = (rem(p-1,6)) * DATA.vsep;    text(xoff,yoff+1,sprintf('%d:%.1f',p,DataClusters{p}.mahal(1)));endset(gca,'xlim',[-8 (npts) * 4-8],'ylim',[-DATA.vsep DATA.vsep*6]); th =  title('Trial');ts = now;stopobj = findobj(gcf,'tag','StopSpool');for nt = 1:length(DATA.Expt.Trials)    AllV.PlotTrialSpikes(DATA,nt);    spstop = get(stopobj,'value');    if spstop        break;    end%    set(th,'string',sprintf('Trial %d',nt));endset(stopobj,'value',0);fprintf('Took %.2f\n',mytoc(ts));    DATA.currenttrial = nt;    set(DATA.toplevel,'UserData',DATA);