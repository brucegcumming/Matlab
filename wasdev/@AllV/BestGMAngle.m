function [theta, c, details] = BestGMAngle(x,y, test, varargin)  a = 0:pi/36:pi;  if diff(size(x)) > 0      G = gmdistribution.fit([x' y'],2,'Options',statset('MaxIter',1000));  else      G = gmdistribution.fit([x y],2,'Options',statset('MaxIter',1000));  end  for j = 1:length(a)      xy = xyrotate(x,y,a(j));      G = gmdistribution.fit(xy(:,1),2,'Options',statset('MaxIter',1000)); %2 Gaussians, 1 dimension      details.mahal(j) = abs(diff(G.mu))./sqrt(mean(G.Sigma));  end [c,id] = max(details.mahal); details.mahal2d = AllV.gmdprime(G); theta = a(id); b = theta-pi/36:pi/360:theta+pi/36; for j = 1:length(b)      xy = xyrotate(x,y,b(j));      G = gmdistribution.fit(xy(:,1),2,'Options',statset('MaxIter',1000)); %2 Gaussians, 1 dimension      finemahal(j) = abs(diff(G.mu))./sqrt(mean(G.Sigma)); endmahals = cat(2,details.mahal, finemahal);[details.angles,id] = sort(cat(2,a,b));details.mahal = mahals(id);[c,id] = max(details.mahal);theta = details.angles(id);    