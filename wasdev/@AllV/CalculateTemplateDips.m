 function [bs, as] = CalculateTemplateDips(DATA)     bs = [];     as = [];     if ~isfield(DATA,'TemplateScores')         return;     end     for j = 1:size(DATA.tmplots,1)         if max(DATA.tmplots(j,:)) > size(DATA.TemplateScores,2)             as(j) = 0;             bs(j) = 0;         else         [as(j),bs(j)] = AllV.BestAngle(DATA.TemplateScores(:,DATA.tmplots(j,1)),DATA.TemplateScores(:,DATA.tmplots(j,2)),1);         end     end