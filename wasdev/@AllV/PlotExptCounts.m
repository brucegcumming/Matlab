function [Expt, plotres] = PlotExptCounts(DATA)    Expt = DATA.Expt;    fitres = [];     AllV.SetFigure(DATA.tag.Expt, DATA);     spkt = DATA.t(DATA.uid(DATA.clst == DATA.currentcluster+1)) .*10000;     preperiod = DATA.preperiod .* 10000;     postperiod = DATA.postperiod .* 10000;     for j = 1:length(DATA.Expt.Trials)         id = find(spkt > Expt.Trials(j).Start(1)-preperiod & spkt < Expt.Trials(j).End(end)+postperiod);         spks = round(spkt(id)'-Expt.Trials(j).Start(1));         Expt.Trials(j).Spikes = spks;         Expt.Trials(j).count = sum(spks > 500 & spks < Expt.Trials(j).dur);     end     if strncmpi(DATA.plot.expttype,'trialcounts',10)         PlotRateSequence(Expt,'callback',@AllV.HitTrial);        %plotres =  PlotExpt(Expt,'seqt');     else         plotres = PlotExpt(Expt,'shown','fbox','rcnmin',10);     end     if DATA.plot.exptfit        fitres = FitExpt(plotres,'plotfit');     end     t = get(gca,'title');     if isfield(fitres,'fitstr')         s = fitres(1).fitstr;     else         s = get(t,'string');     end               p = DATA.probelist(DATA.probe(1));     set(t,'string',sprintf('P%dCl%d %s',p,DATA.currentcluster, s));     