function PlotPCs(pcs, a,b, type, id, colors, C,varargin)ptsz = [1 1];fixrange  = 0;clusterdef = 0;nid = [];j = 1;while j <= length(varargin)    if strncmpi(varargin{j},'clusterdef',5)        j = j+1;        clusterdef = varargin{j};    elseif strncmpi(varargin{j},'fixrange',5)        fixrange = 1;    elseif strncmpi(varargin{j},'ptsz',4)        j = j+1;        ptsz = varargin{j};    elseif strncmpi(varargin{j},'setnid',5)        j = j+1;        nid = varargin{j};        ptsz =  [1 8];    end    j = j+1;endif type(1) == 0    hold off;    if fixrange        xl = get(gca,'xlim');        yl = get(gca,'ylim');    end        if length(id) == size(pcs,1)         nc = unique(id);        nc = nc(nc > 0);        if length(nc) < 8        for j = 1:length(nc)            nid = find(id == nc(j));            plot(pcs(nid,a),pcs(nid,b),'.','markersize',ptsz(2),'color',colors{nc(j)});            hold on;        end        else            plot(pcs(id,a),pcs(id,b),'r.','markersize',ptsz(1));        end    elseif length(id)        if isempty(nid)        nid = setdiff(1:size(pcs,1),id);        end        if length(nid)        plot(pcs(nid,a),pcs(nid,b),'.','markersize',ptsz(2));        hold on;        end        plot(pcs(id,a),pcs(id,b),'r.','markersize',ptsz(1));        hold on;    else        plot(pcs(:,a),pcs(:,b),'.','markersize',ptsz(2));    end    if fixrange        set(gca,'xlim',xl);        set(gca,'ylim',yl);    endelse    hold off;    if length(id) == size(pcs,1)        id = find(id > 0) ; %dont include spikes from excluted trials        [a, D] = DensityPlot(pcs(id,a),pcs(id,b),'sd',[2 2],'ynormal');    else        [a,D] = DensityPlot(pcs(:,a),pcs(:,b),'sd',[2 2],'ynormal');    end    if type(1) == 2        if clusterdef == 1        r = AllV.CalcRadius(C,[D.x(:) D.y(:)]);        id = find(r < 1);        if ~isempty(id)        cmax = max(D.z(id));        caxis([0 cmax]);        end        else            cmax = max(D.z(:)).* sum(id ==clusterdef)./length(id);            caxis([0 cmax]);        end    elseif length(type) > 1        cmax = max(D.z(:));        cmax = cmax .* type(2);        caxis([0 cmax]);            endend